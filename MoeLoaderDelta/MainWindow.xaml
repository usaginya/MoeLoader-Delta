<Window
    x:Class="MoeLoaderDelta.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:MoeLoaderDelta"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    x:Name="Window"
    Width="900"
    Height="640"
    MinWidth="700"
    MinHeight="400"
    Activated="Window_Activated_1"
    AllowsTransparency="True"
    Closed="Window_Closed"
    Closing="Window_Closing"
    Deactivated="Window_Deactivated_1"
    Loaded="Window_Loaded"
    MouseDoubleClick="Window_MouseDoubleClick_1"
    MouseDown="Window_MouseDown_1"
    MouseMove="Window_MouseMove"
    PreviewKeyDown="Window_KeyDown"
    ResizeMode="CanResizeWithGrip"
    StateChanged="Window_StateChanged_1"
    WindowStartupLocation="CenterScreen"
    WindowState="Normal"
    WindowStyle="None"
    mc:Ignorable="d">
    <Window.Resources>
        <Style TargetType="{x:Type local:MainWindow}">
            <!--<Setter Property="shell:WindowChrome.WindowChrome">
                <Setter.Value>
                    <shell:WindowChrome GlassFrameThickness="-1" CaptionHeight="100" ResizeBorderThickness="8"/>
                </Setter.Value>
            </Setter>-->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type local:MainWindow}">
                        <Grid>
                            <Rectangle
                                x:Name="shadowN"
                                Height="6"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Top">
                                <Rectangle.Fill>
                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                        <GradientStop Offset="0" Color="#0034A3E0" />
                                        <GradientStop Offset="1" Color="#6634A3E0" />
                                    </LinearGradientBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                            <Rectangle
                                x:Name="shadowS"
                                Height="6"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Bottom">
                                <Rectangle.Fill>
                                    <LinearGradientBrush StartPoint="0.5,1" EndPoint="0.5,0">
                                        <GradientStop Offset="0" Color="#0034A3E0" />
                                        <GradientStop Offset="1" Color="#6634A3E0" />
                                    </LinearGradientBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                            <Rectangle
                                x:Name="shadowE"
                                Width="6"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Stretch">
                                <Rectangle.Fill>
                                    <LinearGradientBrush StartPoint="1,0.5" EndPoint="0,0.5">
                                        <GradientStop Offset="0" Color="#0034A3E0" />
                                        <GradientStop Offset="1" Color="#6634A3E0" />
                                    </LinearGradientBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                            <Rectangle
                                x:Name="shadowW"
                                Width="6"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Stretch">
                                <Rectangle.Fill>
                                    <LinearGradientBrush StartPoint="0,0.5" EndPoint="1,0.5">
                                        <GradientStop Offset="0" Color="#0034A3E0" />
                                        <GradientStop Offset="1" Color="#6634A3E0" />
                                    </LinearGradientBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                            <ContentPresenter
                                x:Name="contentWnd"
                                Margin="6"
                                Content="{TemplateBinding Content}"
                                SizeChanged="contentWnd_SizeChanged_1" />
                            <ResizeGrip
                                Margin="0,0,7,7"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Bottom"
                                Opacity="0.6"
                                Visibility="Visible" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <DrawingBrush
            x:Key="maxB"
            Viewbox="0,0,34,26"
            ViewboxUnits="Absolute">
            <DrawingBrush.Drawing>
                <ImageDrawing Rect="0,0,34,26">
                    <ImageDrawing.ImageSource>
                        <BitmapImage
                            CacheOption="OnLoad"
                            CreateOptions="IgnoreImageCache"
                            UriSource="/Images/max.png" />
                    </ImageDrawing.ImageSource>
                </ImageDrawing>
            </DrawingBrush.Drawing>
        </DrawingBrush>
        <DrawingBrush
            x:Key="restoreB"
            Viewbox="0,0,34,26"
            ViewboxUnits="Absolute">
            <DrawingBrush.Drawing>
                <ImageDrawing Rect="0,0,34,26">
                    <ImageDrawing.ImageSource>
                        <BitmapImage
                            CacheOption="OnLoad"
                            CreateOptions="IgnoreImageCache"
                            UriSource="/Images/restore.png" />
                    </ImageDrawing.ImageSource>
                </ImageDrawing>
            </DrawingBrush.Drawing>
        </DrawingBrush>
        <Style x:Key="min" TargetType="{x:Type Rectangle}">
            <Setter Property="IsHitTestVisible" Value="False" />
            <Setter Property="HorizontalAlignment" Value="Right" />
            <Setter Property="VerticalAlignment" Value="Top" />
            <Setter Property="Width" Value="34" />
            <Setter Property="Height" Value="26" />
            <Setter Property="Margin" Value="0,0,68,0" />
            <Setter Property="Rectangle.Fill">
                <Setter.Value>
                    <DrawingBrush Viewbox="0,0,34,26" ViewboxUnits="Absolute">
                        <DrawingBrush.Drawing>
                            <ImageDrawing Rect="0,0,34,26">
                                <ImageDrawing.ImageSource>
                                    <BitmapImage
                                        CacheOption="OnLoad"
                                        CreateOptions="IgnoreImageCache"
                                        UriSource="/Images/min.png" />
                                </ImageDrawing.ImageSource>
                            </ImageDrawing>
                        </DrawingBrush.Drawing>
                    </DrawingBrush>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="close" TargetType="{x:Type Rectangle}">
            <Setter Property="IsHitTestVisible" Value="False" />
            <Setter Property="HorizontalAlignment" Value="Right" />
            <Setter Property="VerticalAlignment" Value="Top" />
            <Setter Property="Width" Value="34" />
            <Setter Property="Height" Value="26" />
            <Setter Property="Margin" Value="0,0,0,0" />
            <Setter Property="Rectangle.Fill">
                <Setter.Value>
                    <DrawingBrush Viewbox="0,0,34,26" ViewboxUnits="Absolute">
                        <DrawingBrush.Drawing>
                            <ImageDrawing Rect="0,0,34,26">
                                <ImageDrawing.ImageSource>
                                    <BitmapImage
                                        CacheOption="OnLoad"
                                        CreateOptions="IgnoreImageCache"
                                        UriSource="/Images/close.png" />
                                </ImageDrawing.ImageSource>
                            </ImageDrawing>
                        </DrawingBrush.Drawing>
                    </DrawingBrush>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="max" TargetType="{x:Type Rectangle}">
            <Setter Property="IsHitTestVisible" Value="False" />
            <Setter Property="HorizontalAlignment" Value="Right" />
            <Setter Property="VerticalAlignment" Value="Top" />
            <Setter Property="Width" Value="34" />
            <Setter Property="Height" Value="26" />
            <Setter Property="Margin" Value="0,0,34,0" />
        </Style>
        <Style x:Key="sysbtn" TargetType="{x:Type Button}">
            <!--<Setter Property="BorderThickness" Value="0"/>-->
            <!--<Setter Property="Background" Value="#efeff2"/>-->
            <Setter Property="Width" Value="34" />
            <Setter Property="Height" Value="26" />
            <Setter Property="HorizontalAlignment" Value="Right" />
            <Setter Property="VerticalAlignment" Value="Top" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="back" Background="Transparent" />
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="back" Property="Background" Value="#338CC8DC" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true">
                                <Setter TargetName="back" Property="Background" Value="#ee34A3E0" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="{x:Type ToggleButton}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border Padding="{TemplateBinding Padding}">
                            <Grid
                                Width="Auto"
                                Height="Auto"
                                Margin="0"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Background="#00FFFFFF"
                                SnapsToDevicePixels="False">
                                <Ellipse
                                    x:Name="BackGrad"
                                    Width="19"
                                    Height="19"
                                    Margin="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Fill="#CC34A3E0"
                                    Stroke="#FF34A3E0"
                                    StrokeThickness="1" />
                                <Ellipse
                                    x:Name="FadeMask"
                                    Width="19"
                                    Height="19"
                                    Margin="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Fill="AliceBlue"
                                    Opacity="0"
                                    Stroke="Transparent"
                                    StrokeThickness="1" />
                                <Path
                                    x:Name="arrow"
                                    Margin="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="M1,1.5 L4.5,5 8,1.5"
                                    RenderTransformOrigin="0.5,0.5"
                                    SnapsToDevicePixels="False"
                                    Stroke="White"
                                    StrokeThickness="2">
                                    <Path.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform />
                                            <SkewTransform />
                                            <RotateTransform Angle="90" />
                                            <TranslateTransform />
                                        </TransformGroup>
                                    </Path.RenderTransform>
                                </Path>
                                <Ellipse
                                    x:Name="Highlight"
                                    Width="19"
                                    Height="19"
                                    Margin="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Stroke="Transparent"
                                    StrokeThickness="2"
                                    Visibility="Hidden">
                                    <Ellipse.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <GeometryDrawing>
                                                    <GeometryDrawing.Brush>
                                                        <LinearGradientBrush Opacity="0.6" StartPoint="0,0" EndPoint="0,1">
                                                            <GradientStop Offset="0" Color="White" />
                                                            <GradientStop Offset="1" Color="#CCFFFFFF" />
                                                        </LinearGradientBrush>
                                                    </GeometryDrawing.Brush>
                                                    <GeometryDrawing.Geometry>
                                                        <EllipseGeometry
                                                            Center="0.5,0.5"
                                                            RadiusX="0.25"
                                                            RadiusY="0.5" />
                                                    </GeometryDrawing.Geometry>
                                                </GeometryDrawing>
                                            </DrawingBrush.Drawing>
                                            <DrawingBrush.RelativeTransform>
                                                <ScaleTransform
                                                    CenterX="0.5"
                                                    CenterY="0"
                                                    ScaleX="1.05"
                                                    ScaleY="0.6" />
                                            </DrawingBrush.RelativeTransform>
                                        </DrawingBrush>
                                    </Ellipse.Fill>
                                </Ellipse>
                                <ContentPresenter
                                    x:Name="ContentSite"
                                    Content="{TemplateBinding Content}"
                                    ContentTemplate="{TemplateBinding ContentTemplate}"
                                    RecognizesAccessKey="True" />
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="arrow" Property="RenderTransform">
                                    <Setter.Value>
                                        <RotateTransform Angle="-90" />
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="BackGrad" Property="RenderTransform">
                                    <Setter.Value>
                                        <TranslateTransform X="0" Y="1" />
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <EventTrigger RoutedEvent="UIElement.MouseEnter">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation
                                            Storyboard.TargetName="FadeMask"
                                            Storyboard.TargetProperty="Opacity"
                                            To="0.4"
                                            Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            <EventTrigger RoutedEvent="UIElement.MouseLeave">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation
                                            Storyboard.TargetName="FadeMask"
                                            Storyboard.TargetProperty="Opacity"
                                            To="0"
                                            Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Storyboard x:Key="logoRotate" RepeatBehavior="Forever">
            <ThicknessAnimationUsingKeyFrames Storyboard.TargetName="bgLoading" Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:3" Value="1920,71,0,0" />
            </ThicknessAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="showDownload">
            <ThicknessAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="imgBorder"
                Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:00.2" Value="0,0,219,0" />
            </ThicknessAnimationUsingKeyFrames>
            <ThicknessAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="toggleDownload"
                Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:00.2" Value="0,0,220,0" />
            </ThicknessAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="downloadC"
                Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="1" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="downloadC"
                Storyboard.TargetProperty="(FrameworkElement.Width)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="219" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="0:0:0.2"
                Storyboard.TargetName="toggleDownload"
                Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)">
                <SplineDoubleKeyFrame KeyTime="0:0:0.2" Value="-1.2" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="closeDownload">
            <ThicknessAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="imgBorder"
                Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:00.2" Value="0,0,0,0" />
            </ThicknessAnimationUsingKeyFrames>
            <ThicknessAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="toggleDownload"
                Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:00.2" Value="0,0,0,0" />
            </ThicknessAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="downloadC"
                Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="downloadC"
                Storyboard.TargetProperty="(FrameworkElement.Width)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="0:0:0.2"
                Storyboard.TargetName="toggleDownload"
                Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)">
                <SplineDoubleKeyFrame KeyTime="0:0:0.2" Value="1.2" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="showParam">
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="grdParam"
                Storyboard.TargetProperty="(FrameworkElement.Width)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="479" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="grdParam"
                Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="1" />
            </DoubleAnimationUsingKeyFrames>
            <!--<ThicknessAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="btnGetB" Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:00.3" Value="461,0,0,1"/>
            </ThicknessAnimationUsingKeyFrames>-->
        </Storyboard>
        <Storyboard x:Key="closeParam">
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="grdParam"
                Storyboard.TargetProperty="(FrameworkElement.Width)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="grdParam"
                Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0" />
            </DoubleAnimationUsingKeyFrames>
            <!--<ThicknessAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="btnGetB" Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:00.3" Value="40,0,0,1"/>
            </ThicknessAnimationUsingKeyFrames>-->
        </Storyboard>
        <Style x:Key="prestyle" TargetType="{x:Type Button}">
            <Setter Property="Width" Value="50" />
            <Setter Property="Height" Value="50" />
            <!--<Setter Property="VerticalAlignment" Value="Stretch"/>-->
            <Setter Property="HorizontalAlignment" Value="Right" />
            <Setter Property="Margin" Value="0,0,15,0" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border
                            x:Name="back"
                            Background="Transparent"
                            BorderBrush="LightGray"
                            BorderThickness="1,0,0,1"
                            CornerRadius="0,0,0,10">
                            <Border Background="{TemplateBinding Background}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="back" Property="Background" Value="#efeff2" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true">
                                <Setter TargetName="back" Property="Background" Value="#ebebeb" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="nextstyle" TargetType="{x:Type Button}">
            <Setter Property="Width" Value="50" />
            <Setter Property="Height" Value="50" />
            <!--<Setter Property="VerticalAlignment" Value="Stretch"/>-->
            <Setter Property="HorizontalAlignment" Value="Right" />
            <Setter Property="Margin" Value="0,0,15,0" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border
                            x:Name="back"
                            Background="Transparent"
                            BorderBrush="LightGray"
                            BorderThickness="1,1,0,0"
                            CornerRadius="10,0,0,0">
                            <Border Background="{TemplateBinding Background}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="back" Property="Background" Value="#efeff2" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true">
                                <Setter TargetName="back" Property="Background" Value="#ebebeb" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ToggleButtonStyle1" TargetType="{x:Type ToggleButton}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border
                            Width="34"
                            Height="30"
                            Padding="{TemplateBinding Padding}">
                            <Grid
                                Width="Auto"
                                Height="Auto"
                                Margin="0"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Background="#00FFFFFF"
                                SnapsToDevicePixels="False">
                                <Path
                                    x:Name="BackGrad"
                                    Width="60"
                                    Height="13"
                                    Margin="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="M0,0L30,13 60,0 0,0"
                                    Fill="#CC34A3E0"
                                    RenderTransformOrigin="0.5,0.5"
                                    Stroke="#FFA5BAC6"
                                    StrokeLineJoin="Round"
                                    StrokeThickness="0">
                                    <Path.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform />
                                            <SkewTransform />
                                            <RotateTransform Angle="90" />
                                            <TranslateTransform />
                                        </TransformGroup>
                                    </Path.RenderTransform>
                                </Path>
                                <Path
                                    x:Name="FadeMask"
                                    Width="60"
                                    Height="13"
                                    Margin="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="M0,0L30,13 60,0 0,0"
                                    Fill="AliceBlue"
                                    Opacity="0"
                                    RenderTransformOrigin="0.5,0.5"
                                    Stroke="Transparent"
                                    StrokeThickness="0">
                                    <Path.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform />
                                            <SkewTransform />
                                            <RotateTransform Angle="90" />
                                            <TranslateTransform />
                                        </TransformGroup>
                                    </Path.RenderTransform>
                                </Path>
                                <Path
                                    x:Name="arrow"
                                    Margin="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="M0,-1L18.5,10 35,0 0,0"
                                    Fill="#FFA9C8F4"
                                    RenderTransformOrigin="0.5,0.5"
                                    SnapsToDevicePixels="False"
                                    Stroke="White"
                                    StrokeThickness="1">
                                    <Path.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform ScaleX="0.5" ScaleY="0.5" />
                                            <SkewTransform />
                                            <RotateTransform Angle="90" />
                                            <TranslateTransform />
                                        </TransformGroup>
                                    </Path.RenderTransform>
                                </Path>
                                <ContentPresenter
                                    x:Name="ContentSite"
                                    Content="{TemplateBinding Content}"
                                    ContentTemplate="{TemplateBinding ContentTemplate}"
                                    RecognizesAccessKey="True" />
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <EventTrigger RoutedEvent="UIElement.MouseEnter">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation
                                            Storyboard.TargetName="FadeMask"
                                            Storyboard.TargetProperty="Opacity"
                                            To="0.4"
                                            Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            <EventTrigger RoutedEvent="UIElement.MouseLeave">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation
                                            Storyboard.TargetName="FadeMask"
                                            Storyboard.TargetProperty="Opacity"
                                            To="0"
                                            Duration="0:0:0.25" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Storyboard x:Key="OnMouseEnter2">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="txtSetting" Storyboard.TargetProperty="(TextElement.Foreground).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="0:0:0.2" Value="#666666" />
            </ColorAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="OnMouseEnter3">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="txtHelp" Storyboard.TargetProperty="(TextElement.Foreground).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="0:0:0.2" Value="#666666" />
            </ColorAnimationUsingKeyFrames>
        </Storyboard>

        <DropShadowEffect
            x:Key="PopupDropShadow"
            BlurRadius="10"
            ShadowDepth="2"
            Color="#01000000" />
        <Style x:Key="SimpleMenuItem" TargetType="{x:Type MenuItem}">
            <Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
            <Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Border x:Name="Border" Background="{TemplateBinding Background}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup" />
                                    <ColumnDefinition Width="14" />
                                </Grid.ColumnDefinitions>
                                <Image
                                    x:Name="Ico"
                                    Width="16"
                                    Height="16"
                                    Margin="5,0,4,0"
                                    VerticalAlignment="Center"
                                    Source="{TemplateBinding Icon}" />

                                <Grid
                                    x:Name="GlyphPanel"
                                    Margin="4,0,6,0"
                                    VerticalAlignment="Center"
                                    Visibility="Hidden">
                                    <Path
                                        x:Name="GlyphPanelpath"
                                        VerticalAlignment="Center"
                                        Data="M0,2 L0,4.8 L2.5,7.4 L7.1,2.8 L7.1,0 L2.5,4.6 z"
                                        Fill="{TemplateBinding Foreground}"
                                        FlowDirection="LeftToRight" />
                                </Grid>
                                <ContentPresenter
                                    x:Name="HeaderHost"
                                    Grid.Column="1"
                                    Margin="3"
                                    VerticalAlignment="Center"
                                    ContentSource="Header"
                                    RecognizesAccessKey="True" />
                                <Grid
                                    x:Name="ArrowPanel"
                                    Grid.Column="3"
                                    Margin="4,0,6,0"
                                    VerticalAlignment="Center">
                                    <Path
                                        x:Name="ArrowPanelPath"
                                        VerticalAlignment="Center"
                                        Data="M0,0 L0,8 L4,4 z"
                                        Fill="{TemplateBinding Foreground}" />
                                </Grid>
                                <Popup
                                    x:Name="SubMenuPopup"
                                    AllowsTransparency="true"
                                    Focusable="false"
                                    IsOpen="{Binding Path=IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                    Placement="Right"
                                    PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"
                                    VerticalOffset="-3">
                                    <Grid x:Name="SubMenu">
                                        <Border
                                            x:Name="SubMenuBorder"
                                            Background="{StaticResource WindowBackgroundBrush}"
                                            BorderBrush="{StaticResource SolidBorderBrush}"
                                            BorderThickness="1" />

                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                    </Grid>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="Role" Value="TopLevelHeader">
                                <Setter Property="Margin" Value="0,1,0,1" />
                                <Setter Property="Padding" Value="6,3,6,3" />
                                <Setter Property="Grid.IsSharedSizeScope" Value="true" />
                                <Setter TargetName="SubMenuPopup" Property="Placement" Value="Bottom" />
                                <Setter TargetName="ArrowPanel" Property="Visibility" Value="Collapsed" />
                            </Trigger>
                            <Trigger Property="Role" Value="TopLevelItem">
                                <Setter Property="Margin" Value="0,1,0,1" />
                                <Setter Property="Padding" Value="6,3,6,3" />
                                <Setter TargetName="ArrowPanel" Property="Visibility" Value="Collapsed" />
                            </Trigger>
                            <Trigger Property="Role" Value="SubmenuHeader">
                                <Setter Property="DockPanel.Dock" Value="Top" />
                                <Setter Property="Padding" Value="0,2,0,2" />
                                <Setter Property="Grid.IsSharedSizeScope" Value="true" />
                            </Trigger>
                            <Trigger Property="Role" Value="SubmenuItem">
                                <Setter Property="DockPanel.Dock" Value="Top" />
                                <Setter Property="Padding" Value="0,2,0,2" />
                                <Setter TargetName="ArrowPanel" Property="Visibility" Value="Collapsed" />
                            </Trigger>
                            <Trigger Property="IsSuspendingPopupAnimation" Value="true">
                                <Setter TargetName="SubMenuPopup" Property="PopupAnimation" Value="None" />
                            </Trigger>
                            <Trigger Property="Icon" Value="{x:Null}">
                                <Setter TargetName="Ico" Property="Visibility" Value="Collapsed" />
                            </Trigger>
                            <!--<Trigger Property="IsChecked" Value="true">
                                <Setter Property="Visibility" Value="Visible" TargetName="GlyphPanel"/>
                                <Setter Property="Visibility" Value="Collapsed" TargetName="Ico"/>
                            </Trigger>-->
                            <Trigger SourceName="SubMenuPopup" Property="AllowsTransparency" Value="true">
                                <Setter TargetName="SubMenu" Property="Margin" Value="0,0,8,8" />
                                <Setter TargetName="SubMenu" Property="SnapsToDevicePixels" Value="true" />
                                <Setter TargetName="SubMenuBorder" Property="Effect" Value="{StaticResource PopupDropShadow}" />
                            </Trigger>
                            <Trigger Property="IsHighlighted" Value="true">
                                <Setter TargetName="Border" Property="Background" Value="#CC1F78D6" />
                                <Setter Property="Foreground" Value="#FFF" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="{StaticResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Storyboard x:Key="sbNavi">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="grdNavi" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)">
                <SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="grdNavi" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)">
                <SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="grdNavi" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
                <SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="200" />
                <SplineDoubleKeyFrame KeyTime="0:0:0.6" Value="0" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="grdNavi" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                <SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="-200" />
                <SplineDoubleKeyFrame KeyTime="0:0:0.6" Value="0" />
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="grdNavi" Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0" />
                <SplineDoubleKeyFrame KeyTime="0:0:0.7" Value="0" />
                <SplineDoubleKeyFrame KeyTime="0:0:1" Value="1" />
            </DoubleAnimationUsingKeyFrames>
            <ThicknessAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="grdNavi"
                Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:0.6" Value="0,-35,0,0" />
            </ThicknessAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="grdNavi" Storyboard.TargetProperty="(FrameworkElement.HorizontalAlignment)">
                <DiscreteObjectKeyFrame KeyTime="0:0:0.6" Value="{x:Static HorizontalAlignment.Right}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="grdNavi" Storyboard.TargetProperty="(FrameworkElement.VerticalAlignment)">
                <DiscreteObjectKeyFrame KeyTime="0:0:0.6" Value="{x:Static VerticalAlignment.Top}" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="showFuncBtns">
            <ThicknessAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="grdFuncBtns"
                Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:00.1" Value="0,0,15,0" />
            </ThicknessAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="grdFuncBtns"
                Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.1" Value="1" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="hideFuncBtns">
            <ThicknessAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="grdFuncBtns"
                Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="00:00:00.1" Value="0,0,-200,0" />
            </ThicknessAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames
                BeginTime="00:00:00"
                Storyboard.TargetName="grdFuncBtns"
                Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.1" Value="0" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="sbShowPageBtnPrev">
            <ThicknessAnimationUsingKeyFrames Storyboard.TargetName="btnPrev" Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="0" Value="0,200,15,0" />
                <SplineThicknessKeyFrame
                    KeySpline="0,0,0.5,1"
                    KeyTime="0:0:0.8"
                    Value="0,0,15,0" />
            </ThicknessAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="btnPrev" Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="0" Value="0" />
                <SplineDoubleKeyFrame
                    KeySpline="0,0,0.5,1"
                    KeyTime="0:0:0.5"
                    Value="1" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="sbShowPageBtnNext">
            <ThicknessAnimationUsingKeyFrames Storyboard.TargetName="btnNext" Storyboard.TargetProperty="(FrameworkElement.Margin)">
                <SplineThicknessKeyFrame KeyTime="0" Value="0,0,15,200" />
                <SplineThicknessKeyFrame
                    KeySpline="0,0,0.5,1"
                    KeyTime="0:0:0.8"
                    Value="0,0,15,0" />
            </ThicknessAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="btnNext" Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="0" Value="0" />
                <SplineDoubleKeyFrame
                    KeySpline="0,0,0.5,1"
                    KeyTime="0:0:0.5"
                    Value="1" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="ClosedStoryboard" Storyboard.TargetName="Window">
            <DoubleAnimation
                Storyboard.TargetProperty="OpacityMask.(GradientBrush.GradientStops)[1].Offset"
                From="1"
                To="0"
                Duration="0:0:.1" />
            <DoubleAnimation
                BeginTime="0:0:.1"
                Storyboard.TargetProperty="OpacityMask.(GradientBrush.GradientStops)[2].Offset"
                From="1"
                To="0"
                Duration="0:0:.1" />
            <ColorAnimation
                Storyboard.TargetProperty="OpacityMask.(GradientBrush.GradientStops)[2].Color"
                To="#00000000"
                Duration="0" />
        </Storyboard>
        <LinearGradientBrush x:Key="ClosedBrush" StartPoint="0,1" EndPoint="1,0">
            <GradientStop Offset="0" Color="#FF000000" />
            <GradientStop Offset="1" Color="#FF000000" />
            <GradientStop Offset="1" Color="#FF000000" />
        </LinearGradientBrush>
    </Window.Resources>
    <Window.Triggers>
        <EventTrigger RoutedEvent="Mouse.MouseEnter" SourceName="txtSetting">
            <BeginStoryboard x:Name="OnMouseEnter2_BeginStoryboard" Storyboard="{StaticResource OnMouseEnter2}" />
        </EventTrigger>
        <EventTrigger RoutedEvent="Mouse.MouseLeave" SourceName="txtSetting">
            <StopStoryboard BeginStoryboardName="OnMouseEnter2_BeginStoryboard" />
        </EventTrigger>
        <EventTrigger RoutedEvent="Mouse.MouseEnter" SourceName="txtHelp">
            <BeginStoryboard x:Name="OnMouseEnter3_BeginStoryboard" Storyboard="{StaticResource OnMouseEnter3}" />
        </EventTrigger>
        <EventTrigger RoutedEvent="Mouse.MouseLeave" SourceName="txtHelp">
            <StopStoryboard BeginStoryboardName="OnMouseEnter3_BeginStoryboard" />
        </EventTrigger>
        <EventTrigger RoutedEvent="Loaded">
            <EventTrigger.Actions>
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation
                            Storyboard.TargetProperty="OpacityMask.(GradientBrush.GradientStops)[1].Offset"
                            From="1"
                            To="0"
                            Duration="0:0:.15" />
                        <DoubleAnimation
                            BeginTime="0:0:.15"
                            Storyboard.TargetProperty="OpacityMask.(GradientBrush.GradientStops)[2].Offset"
                            From="1"
                            To="0"
                            Duration="0:0:.15" />
                        <ColorAnimation
                            Storyboard.TargetProperty="OpacityMask.(GradientBrush.GradientStops)[2].Color"
                            To="#FF000000"
                            Duration="0" />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger.Actions>
        </EventTrigger>
    </Window.Triggers>
    <Window.OpacityMask>
        <LinearGradientBrush StartPoint="1,1" EndPoint="0,0">
            <GradientStop Offset="0" Color="#00000000" />
            <GradientStop Offset="1" Color="#00000000" />
            <GradientStop Offset="1" Color="#FF000000" />
        </LinearGradientBrush>
    </Window.OpacityMask>
    <Border
        x:Name="containerB"
        Background="WhiteSmoke"
        BorderBrush="#34A3E0"
        BorderThickness="3">
        <Grid x:Name="grdBg" Background="Transparent">
            <Grid x:Name="grid" Margin="0,0,0,30">
                <Border
                    x:Name="bdDecorate"
                    Width="10"
                    Height="71"
                    Margin="0,0,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top">
                    <Border.Background>
                        <LinearGradientBrush Opacity="0.6" StartPoint="0.5,0" EndPoint="0.5,1">
                            <GradientStop Offset="0" Color="#34A3E0" />
                            <GradientStop Offset="1" Color="#35b5e4" />
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>

                <Button
                    Margin="0,0,68,0"
                    Click="Min_Click"
                    Style="{StaticResource sysbtn}" />
                <Button
                    Margin="0,0,34,0"
                    Click="Max_Click"
                    Style="{StaticResource sysbtn}" />
                <Button
                    Margin="0,0,0,0"
                    Click="Close_Click"
                    Style="{StaticResource sysbtn}" />
                <Rectangle Style="{StaticResource close}" />
                <Rectangle
                    x:Name="maxBtn"
                    Fill="{StaticResource maxB}"
                    Style="{DynamicResource max}" />
                <Rectangle Style="{StaticResource min}" />
                <Grid Margin="0,35,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="341*" />
                        <ColumnDefinition Width="100*" />
                    </Grid.ColumnDefinitions>
                    <Grid
                        x:Name="imgListGrid"
                        Grid.ColumnSpan="2"
                        Margin="0,36,0,39">
                        <Border
                            x:Name="imgBorder"
                            Margin="0"
                            Background="#8FFFFFFF"
                            BorderBrush="#4C000000"
                            CornerRadius="0">
                            <Grid x:Name="imgLstBg">
                                <ScrollViewer
                                    x:Name="scrList"
                                    Margin="0,1,0,1"
                                    HorizontalScrollBarVisibility="Disabled"
                                    PanningMode="VerticalOnly"
                                    VerticalScrollBarVisibility="Auto">
                                    <ScrollViewer.ContextMenu>
                                        <ContextMenu MinWidth="160">
                                            <MenuItem
                                                x:Name="itmSelectInverse"
                                                Click="itmSelectInverse_Click"
                                                Header="反選(_I)"
                                                IsEnabled="False" />
                                            <MenuItem
                                                x:Name="itmSelectAll"
                                                Click="itmSelectAll_Click"
                                                Header="全選(_A)"
                                                IsEnabled="False" />
                                            <MenuItem
                                                x:Name="itmUnSelectAll"
                                                Click="itmUnSelectAll_Click"
                                                Header="全不選(_Z)"
                                                IsEnabled="False" />
                                            <MenuItem
                                                x:Name="itmReload"
                                                Click="itmReload_Click"
                                                Header="重試(_R)"
                                                IsEnabled="False"
                                                ToolTip="重試載入失敗的縮圖" />
                                            <Separator />
                                            <MenuItem
                                                x:Name="itmSmallPre"
                                                Click="itmSmallPre_Click"
                                                Header="使用小縮圖(_S)"
                                                IsCheckable="True" />
                                            <MenuItem Header="圖片地址類型(_T)" ToolTip="此設定決定導出和下載時使用的圖片地址">
                                                <MenuItem
                                                    x:Name="itmTypeOri"
                                                    Click="itmTypeOri_Checked"
                                                    Header="原圖(_1)"
                                                    IsCheckable="True"
                                                    ToolTip="使用原圖地址(大)" />
                                                <MenuItem
                                                    x:Name="itmTypeJpg"
                                                    Click="itmTypeOri_Checked"
                                                    Header="JPG格式(_2)"
                                                    IsCheckable="True"
                                                    ToolTip="優先使用圖片的JPG格式地址(較大)" />
                                                <MenuItem
                                                    x:Name="itmTypePreview"
                                                    Click="itmTypeOri_Checked"
                                                    Header="預覽圖(_3)"
                                                    IsCheckable="True"
                                                    ToolTip="使用預覽圖地址(較小)" />
                                                <MenuItem
                                                    x:Name="itmTypeSmall"
                                                    Click="itmTypeOri_Checked"
                                                    Header="縮圖(_4)"
                                                    IsCheckable="True"
                                                    ToolTip="使用縮圖地址(小)" />
                                            </MenuItem>
                                            <MenuItem Header="圖片篩選(_M)">
                                                <MenuItem x:Name="itmMaskScore" Header="篩選指定分數">
                                                    <MenuItem
                                                        x:Name="itm0"
                                                        Checked="itm5_Checked"
                                                        Header="0分(_1)"
                                                        IsCheckable="True" />
                                                    <MenuItem
                                                        x:Name="itm5"
                                                        Checked="itm5_Checked"
                                                        Header="5分以上(_2)"
                                                        IsCheckable="True" />
                                                    <MenuItem
                                                        x:Name="itm10"
                                                        Checked="itm5_Checked"
                                                        Header="10分以上(_3)"
                                                        IsCheckable="True" />
                                                    <MenuItem
                                                        x:Name="itm20"
                                                        Checked="itm5_Checked"
                                                        Header="20分以上(_4)"
                                                        IsCheckable="True" />
                                                    <MenuItem
                                                        x:Name="itm30"
                                                        Checked="itm5_Checked"
                                                        Header="30分以上(_5)"
                                                        IsCheckable="True" />
                                                </MenuItem>
                                                <MenuItem x:Name="itmMaskRes" Header="篩選指定解析度">
                                                    <MenuItem
                                                        x:Name="itmx0"
                                                        Checked="itmx5_Checked"
                                                        Header="800x600 以上(_1)"
                                                        IsCheckable="True" />
                                                    <MenuItem
                                                        x:Name="itmx5"
                                                        Checked="itmx5_Checked"
                                                        Header="1024x768 以上(_2)"
                                                        IsCheckable="True" />
                                                    <MenuItem
                                                        x:Name="itmx10"
                                                        Checked="itmx5_Checked"
                                                        Header="1280x720 以上(_3)"
                                                        IsCheckable="True" />
                                                    <MenuItem
                                                        x:Name="itmx20"
                                                        Checked="itmx5_Checked"
                                                        Header="1680x1050 以上(_4)"
                                                        IsCheckable="True" />
                                                    <MenuItem
                                                        x:Name="itmx30"
                                                        Checked="itmx5_Checked"
                                                        Header="1920x1080 以上(_5)"
                                                        IsCheckable="True" />
                                                    <!--<MenuItem x:Name="itmx40" Header="1920x1080 以上(_6)" IsCheckable="True" Checked="itmx5_Checked"/>-->
                                                </MenuItem>
                                                <Separator />
                                                <MenuItem
                                                    x:Name="itmMaskViewed"
                                                    Header="過濾已瀏覽的圖片(_0)"
                                                    IsCheckable="True" />
                                                <MenuItem
                                                    x:Name="itmxExplicit"
                                                    Click="itmxExplicit_Click"
                                                    Header="過濾限制級圖片(_E)"
                                                    IsCheckable="True" />
                                            </MenuItem>
                                            <Separator />
                                            <MenuItem
                                                x:Name="itmOpenSite"
                                                Click="itmOpenSite_Click"
                                                Header="訪問站點首頁(_W)" />
                                        </ContextMenu>
                                    </ScrollViewer.ContextMenu>
                                    <WrapPanel x:Name="imgPanel" Margin="20,0,45,0" />
                                </ScrollViewer>
                                <Button
                                    x:Name="btnPrev"
                                    Margin="0"
                                    VerticalAlignment="Top"
                                    Click="btnPrev_Click"
                                    IsEnabled="False"
                                    Style="{DynamicResource prestyle}"
                                    ToolTip="上一頁"
                                    Visibility="Hidden">
                                    <Button.Background>
                                        <ImageBrush ImageSource="Images/page.png" Stretch="None" />
                                    </Button.Background>
                                </Button>
                                <Button
                                    x:Name="btnNext"
                                    Margin="0"
                                    VerticalAlignment="Bottom"
                                    Click="btnNext_Click"
                                    IsEnabled="False"
                                    RenderTransformOrigin="0.5,0.5"
                                    Style="{DynamicResource nextstyle}"
                                    ToolTip="下一頁 (Ctrl + → 強制翻頁)"
                                    Visibility="Hidden">
                                    <Button.Background>
                                        <ImageBrush ImageSource="Images/page.png" Stretch="None">
                                            <ImageBrush.RelativeTransform>
                                                <TransformGroup>
                                                    <ScaleTransform
                                                        CenterX="0.5"
                                                        CenterY="0.5"
                                                        ScaleX="1"
                                                        ScaleY="-1" />
                                                </TransformGroup>
                                            </ImageBrush.RelativeTransform>
                                        </ImageBrush>
                                    </Button.Background>
                                </Button>
                            </Grid>
                        </Border>
                        <local:DownloadControl
                            x:Name="downloadC"
                            Width="0"
                            HorizontalAlignment="Right"
                            x:FieldModifier="internal"
                            AllowDrop="True"
                            Opacity="0" />
                        <ToggleButton
                            x:Name="toggleDownload"
                            Width="25"
                            Margin="0,0,-2,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            BorderThickness="1,1,1,1"
                            Click="toggleDownload_Click"
                            RenderTransformOrigin="1,0.5"
                            Style="{DynamicResource ToggleButtonStyle1}"
                            ToolTip="顯示下載面板(按住Ctrl隱藏縮圖)">
                            <ToggleButton.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform ScaleX="1.2" ScaleY="1.5" />
                                    <SkewTransform />
                                    <RotateTransform />
                                    <TranslateTransform />
                                </TransformGroup>
                            </ToggleButton.RenderTransform>
                        </ToggleButton>
                        <Grid
                            x:Name="grdNavi"
                            Width="385"
                            Height="30"
                            Margin="0,-10,10,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center">
                            <Grid.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform ScaleX="1.1" ScaleY="1.1" />
                                    <SkewTransform />
                                    <RotateTransform />
                                    <TranslateTransform />
                                </TransformGroup>
                            </Grid.RenderTransform>
                            <Grid
                                x:Name="grdSite"
                                Width="135"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top">
                                <Menu
                                    Height="25"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    BorderBrush="LightGray"
                                    BorderThickness="1,1,0,1">
                                    <MenuItem
                                        x:Name="siteMenu"
                                        Width="{Binding ActualWidth, ElementName=grdSite}"
                                        Height="25"
                                        Margin="0"
                                        Padding="6,0"
                                        Background="White"
                                        Header="無站點"
                                        Style="{StaticResource SimpleMenuItem}" />
                                </Menu>
                                <Grid
                                    Width="16"
                                    Height="23"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    IsHitTestVisible="False">
                                    <!--<Rectangle HorizontalAlignment="Stretch" x:Name="Rectangle" VerticalAlignment="Stretch" Width="Auto" Height="Auto" RadiusX="0" RadiusY="0" Fill="{StaticResource NormalBrush}" Stroke="{StaticResource NormalBorderBrush}"/>-->
                                    <Path
                                        x:Name="Arrow"
                                        Margin="0,0,3,0"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Center"
                                        Data="M 0 0 L 4 4 L 8 0 Z"
                                        Fill="#222222" />
                                </Grid>
                            </Grid>
                            <local:SearchControl
                                x:Name="searchControl"
                                Width="180"
                                Height="25"
                                Margin="135,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                BorderBrush="LightGray"
                                BorderThickness="1,1,1,1" />
                            <Button
                                x:Name="btnGet"
                                Width="60"
                                Height="25"
                                Margin="314,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                Background="#EEEEEE"
                                BorderBrush="LightGray"
                                Click="Button_Click"
                                IsDefault="True"
                                Tag="搜尋圖片 (按住Shift鍵時會用新的搜尋設定重新搜尋當前頁)">
                                <Grid Width="60" Height="25">
                                    <AccessText
                                        x:Name="txtGet"
                                        Margin="25,5,11,5"
                                        VerticalAlignment="Center"
                                        Text="搜尋" />
                                    <Image
                                        x:Name="imgGet"
                                        Margin="4"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        Source="/Images/search.png"
                                        Stretch="None" />
                                </Grid>
                            </Button>
                        </Grid>
                    </Grid>
                    <Grid
                        x:Name="grdFuncBtns"
                        Grid.Column="1"
                        Margin="0,0,-200,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Bottom"
                        IsEnabled="False"
                        Opacity="0">
                        <Button
                            x:Name="ButtonMainDL"
                            Width="85"
                            Height="28"
                            Margin="0,0,0,1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Bottom"
                            Click="Download_Click"
                            ToolTip="下載選中的圖片">
                            <AccessText Text="下載(_D)" />
                        </Button>
                        <Button
                            Width="85"
                            Height="28"
                            Margin="0,0,105,1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Bottom"
                            Click="itmLst_Click"
                            ToolTip="生成選中圖片的下載列表檔案">
                            <AccessText Text="導出列表(_L)" />
                        </Button>
                    </Grid>

                    <!--<ComboBox x:Name="comboBox1" HorizontalAlignment="Right" VerticalAlignment="Top" Width="160" Style="{StaticResource SimpleComboBox}" Margin="0,1,30,0" SelectionChanged="comboBox1_SelectionChanged" />-->
                    <ToggleButton
                        x:Name="togglePram"
                        Margin="10,0,0,4"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Bottom"
                        Click="togglePram_Click"
                        IsChecked="True"
                        Tag="隱藏搜尋設定"
                        ToolTip="顯示搜尋設定" />
                    <Grid
                        x:Name="grdParam"
                        Width="0"
                        Margin="35,0,0,-1"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Bottom"
                        Opacity="0">
                        <!--<TextBlock Text="關鍵字" HorizontalAlignment="Left" Margin="0" d:LayoutOverrides="Height" VerticalAlignment="Center" Style="{StaticResource glowT}"/>-->
                        <TextBlock
                            x:Name="textBlock"
                            Margin="2,0,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Style="{StaticResource glowT}"
                            Text="起始頁碼"
                            d:LayoutOverrides="Height" />
                        <StackPanel
                            x:Name="stackPanel"
                            Margin="55,0,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            ToolTip="起始頁碼">
                            <TextBox
                                x:Name="txtPage"
                                Width="50"
                                Margin="5,5,0,4"
                                x:FieldModifier="private"
                                InputMethod.IsInputMethodEnabled="False"
                                LostFocus="txtPage_LostFocus"
                                MaxLength="5"
                                PreviewKeyDown="txtPage_PreviewKeyDown"
                                Style="{DynamicResource SimpleTextBox}"
                                Text="1"
                                TextChanged="txtNum_TextChanged" />
                            <Button
                                x:Name="pageUp"
                                Width="15"
                                Margin="0,5,0,4"
                                x:FieldModifier="private"
                                BorderThickness="1"
                                Click="pageUp_Click"
                                Content="˄"
                                Style="{DynamicResource SimpleButton}" />
                            <Button
                                x:Name="pageDown"
                                Width="15"
                                Margin="0,5,0,4"
                                x:FieldModifier="private"
                                BorderThickness="1"
                                Click="pageDown_Click"
                                Content="˅"
                                Style="{DynamicResource SimpleButton}" />
                        </StackPanel>
                        <TextBlock
                            x:Name="textBlock1"
                            Margin="150,0,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Style="{StaticResource glowT}"
                            Text="每頁數量" />
                        <StackPanel
                            x:Name="stackPanel1"
                            Width="100"
                            Margin="204,0,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            ToolTip="每頁搜尋的圖片數量">
                            <TextBox
                                x:Name="txtNum"
                                Width="50"
                                Margin="5,5,0,4"
                                x:FieldModifier="private"
                                InputMethod.IsInputMethodEnabled="False"
                                LostFocus="txtPage_LostFocus"
                                MaxLength="3"
                                PreviewKeyDown="txtPage_PreviewKeyDown"
                                Style="{DynamicResource SimpleTextBox}"
                                Text="50"
                                TextChanged="txtNum_TextChanged" />
                            <Button
                                x:Name="numUp"
                                Width="15"
                                Margin="0,5,0,4"
                                x:FieldModifier="private"
                                BorderThickness="1"
                                Click="numUp_Click"
                                Content="˄"
                                Style="{DynamicResource SimpleButton}" />
                            <Button
                                x:Name="numDown"
                                Width="15"
                                Margin="0,5,0,4"
                                x:FieldModifier="private"
                                BorderThickness="1"
                                Click="numDown_Click"
                                Content="˅"
                                Style="{DynamicResource SimpleButton}" />
                        </StackPanel>
                    </Grid>
                </Grid>
                <Grid
                    x:Name="logoGrd"
                    Height="60"
                    Margin="5,0,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top">
                    <Image
                        x:Name="image"
                        Width="120"
                        Height="60"
                        Margin="10,10,0,0"
                        HorizontalAlignment="Left"
                        RenderTransformOrigin="0.50,0.50"
                        Source="Images/logo1.png"
                        Stretch="None" />
                    <Image
                        Width="160"
                        Height="60"
                        Margin="110,10,0,0"
                        HorizontalAlignment="Left"
                        Source="Images/logo3.png" />
                </Grid>
                <Border
                    x:Name="bgLoading"
                    Width="300"
                    Height="3"
                    Margin="-300,70,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top">
                    <Border.Background>
                        <LinearGradientBrush Opacity="1" StartPoint="0,0.5" EndPoint="1,0.5">
                            <GradientStop Offset="0" Color="#00FFFFFF" />
                            <GradientStop Offset="0.5" Color="#993585E4" />
                            <GradientStop Offset="1" Color="#00FFFFFF" />
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
            </Grid>
            <Grid
                Margin="0,9,150,0"
                HorizontalAlignment="Right"
                VerticalAlignment="Top">
                <TextBlock
                    x:Name="txtSetting"
                    Margin="0"
                    Cursor="Hand"
                    FontSize="11"
                    MouseDown="TextBlock_MouseDown1"
                    Style="{StaticResource glowT}"
                    Text="設定"
                    TextDecorations="Underline" />
                <TextBlock
                    Margin="28,0,0,0"
                    FontSize="11"
                    Style="{StaticResource glowT}"
                    Text="|" />
                <TextBlock
                    x:Name="txtHelp"
                    Margin="36,0,0,0"
                    Cursor="Hand"
                    FontSize="11"
                    MouseDown="TextBlock_MouseDown2"
                    Style="{StaticResource glowT}"
                    Text="幫助"
                    TextDecorations="Underline" />
            </Grid>

            <Border
                Height="25"
                Margin="-3,0,-3,-3"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Bottom"
                Background="#3585E4">
                <Grid>
                    <TextBlock
                        x:Name="statusText"
                        Margin="15,0,0,0"
                        VerticalAlignment="Center"
                        Foreground="White"
                        Style="{StaticResource glowT}"
                        Text="輸入關鍵字標籤進行圖片搜尋、無關鍵字將直接搜尋最新圖片" />
                    <TextBlock
                        x:Name="siteText"
                        Margin="0,0,290,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Foreground="White"
                        Style="{StaticResource glowT}"
                        Text="當前站點 yande" />
                    <TextBlock
                        x:Name="pageText"
                        Margin="0,0,170,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Foreground="White"
                        Style="{StaticResource glowT}"
                        Text="當前頁碼 0" />
                    <TextBlock
                        x:Name="selText"
                        Margin="0,0,50,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Foreground="White"
                        Style="{StaticResource glowT}"
                        Text="選中圖片 0" />
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
